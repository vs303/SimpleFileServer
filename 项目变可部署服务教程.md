要将 .NET Core 6 API 程序发布为 Windows 服务，可以遵循以下步骤：

1. **创建 .NET Core 控制台应用程序**：首先，您需要将现有的 .NET Core API 项目更改为控制台应用程序。这样一来，当您的应用程序作为服务运行时，它将能够与服务控制管理器 (SCM) 交互。

要将现有的 ASP.NET Core 项目更改为控制台应用程序，请在 `.csproj` 文件中进行以下更改：

```
<Project Sdk="Microsoft.NET.Sdk.Web">

  <PropertyGroup>
    <TargetFramework>net6.0</TargetFramework>
  </PropertyGroup>

  <!-- Other elements -->

</Project>
```

更改为：

```
<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <OutputType>Exe</OutputType>
    <TargetFramework>net6.0</TargetFramework>
  </PropertyGroup>

  <!-- Other elements -->

  <ItemGroup>
    <FrameworkReference Include="Microsoft.AspNetCore.App" />
  </ItemGroup>

</Project>
```

请注意，我们已经更改了 `Sdk`、`OutputType` 和添加了对 `Microsoft.AspNetCore.App` 的框架引用。

1. **实现服务功能**：接下来，您需要向应用程序添加一些代码，以便它能够作为服务运行。您可以使用 `Microsoft.Extensions.Hosting` NuGet 包中提供的泛型主机来实现此目的。

首先，安装 `Microsoft.Extensions.Hosting` 和 `Microsoft.Extensions.Hosting.WindowsServices` NuGet 包。然后，在 `Program.cs` 中进行以下更改：

```
public class Program
{
    public static void Main(string[] args)
    {
        CreateHostBuilder(args).Build().Run();
    }

    public static IHostBuilder CreateHostBuilder(string[] args) =>
        Host.CreateDefaultBuilder(args)
            .ConfigureWebHostDefaults(webBuilder =>
            {
                webBuilder.UseStartup<Startup>();
            });
}
```

更改为：

```
using Microsoft.Extensions.Hosting;
using Microsoft.Extensions.Hosting.WindowsServices;

public class Program
{
    public static void Main(string[] args)
    {
        CreateHostBuilder(args).Build().Run();
    }

    public static IHostBuilder CreateHostBuilder(string[] args) =>
        Host.CreateDefaultBuilder(args)
            .ConfigureWebHostDefaults(webBuilder =>
            {
                webBuilder.UseStartup<Startup>();
            })
            .UseWindowsService(options =>
            {
                options.ServiceName = "MyApiService";
            });
}
```

请注意，我们已经添加了对 `Microsoft.Extensions.Hosting` 和 `Microsoft.Extensions.Hosting.WindowsServices` 的使用，并且在主机生成器中调用了 `UseWindowsService` 方法。

1. **发布应用程序**：现在，您可以将应用程序发布为可在目标计算机上安装的自包含部署。

```
dotnet publish -c Release -r win-x64 --self-contained true
```

1. **创建和安装服务**：最后，您需要在目标计算机上创建和安装服务。您可以使用 `sc.exe` 实用程序或 Powershell 的 `New-Service` cmdlet 来执行此操作。

例如，使用 `sc.exe` 的命令如下所示：

```
sc.exe create MyApiService binPath= "C:\path\to\your\app\MyApiService.exe"
```